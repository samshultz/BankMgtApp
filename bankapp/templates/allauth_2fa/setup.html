{% extends "base.html" %}
{% load widget_tweaks %}

{% block title %}
  Activate Two Factor Authentication
{% endblock title %}

{% block header %}
  <!-- App Header -->
  <div class="appHeader">
    <div class="left">
        <a href="#" class="headerButton goBack">
            <ion-icon name="chevron-back-outline"></ion-icon>
        </a>
    </div>
    <div class="pageTitle">
        2FA
    </div>
    <div class="right">
    </div>
</div>
<!-- * App Header -->
{% endblock header %}

{% block body %}

<div class="section inset mt-3">
  <div class="wide-block pt-2 pb-2 text-center">
      <h4 class="font-weight-bold mb-05">Set Up App on a Different Device</h4>
      <p>
        Once you've installed an authentication app (for example Google 
        Authenticator or Duo Mobile), you can set up this account. From there
        you can either scan this barcode or enter a code.
      </p>
      <a href="{{ qr_code_url }}" class="btn btn-primary">
        Setup on same device
      </a>
      <hr>
      <div class="mb-1">
        <img src="{{ qr_code_url }}" alt="Barcode" class="imaged w-75">
      </div>
  </div>
        <a class="btn btn-primary btn-block" data-toggle="modal" data-target="#OTPForm">Continue</a>
</div>

<!-- Dialog Form -->
<div class="modal fade dialogbox" id="OTPForm" data-backdrop="static" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title">Enter Confirmation Code</h5>
          </div>
          {% if form.errors %}
            {% for field in form %}
              {% for error in field.errors %}
                <div class="alert alert-outline-danger mb-1">
                  <strong>{{ error|escape }}</strong>
                </div>
              {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
              <div class="alert alert-outline-danger mb-1">
                <strong>{{ error|escape }}</strong>
              </div>
            {% endfor %}
          {% endif %}
          <form method="post">
            {% csrf_token %}
              <div class="modal-body text-left mb-2">
                  <div class="form-group boxed">
                      <div class="input-wrapper">
                          <label class="label" for="otptoken">{{ form.token.label }}</label>
                          {% render_field form.token|add_class:"form-control verification-input text-center" id="otptoken" placeholder="••••••" maxlength="6" %}
                          <i class="clear-input"><ion-icon name="close-circle"></ion-icon></i>
                      </div>
                  </div>
              </div>
              <div class="modal-footer">
                  <div class="btn-inline">
                      <button type="button" class="btn btn-text-secondary" data-dismiss="modal">Cancel</button>
                      <button type="submit" class="btn btn-text-primary">Continue</button>
                  </div>
              </div>
          </form>
      </div>
  </div>
</div>
<!-- * Dialog Form -->
<noscript>

  <form method="post">
    {% csrf_token %}
    {{ form.non_field_errors }}
    {{ form.token.label }}: {{ form.token }}
  
    <button type="submit">
      Verify
    </button>
  </form>
</noscript>
  
{% endblock body %}